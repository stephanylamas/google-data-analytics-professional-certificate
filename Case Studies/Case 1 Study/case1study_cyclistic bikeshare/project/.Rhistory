q1_2019 <- q1_2019 %>% rename(bike_id = bikeid)
q1_2019 <- q1_2019 %>% rename(trip_duration = tripduration)
q1_2019 <- q1_2019 %>% rename(user_type = usertype)
q1_2019 <- q1_2019 %>% rename(start_station_id = from_station_id)
q1_2019 <- q1_2019 %>% rename(start_station_name = from_station_name)
q1_2019 <- q1_2019 %>% rename(end_station_name = finish_station_id)
view(q1_2019)
q1_2020 <- read.csv("divvy_trips_2020_q1.csv")
q1_2019 <- read.csv("divvy_trips_2019_q1.csv")
conflict_prefer("filter", "dplyr")
library(tidyverse)
library(conflicted)
conflict_prefer("filter", "dplyr")
conflict_prefer("lag", "dplyr")
(q1_2019 <- rename(q1_2019
,ride_id = trip_id
,rideable_type = bikeid
,started_at = start_time
,ended_at = end_time
,start_station_name = from_station_name
,start_station_id = from_station_id
,end_station_name = to_station_name
,end_station_id = to_station_id
,member_casual = usertype
))
q1_2019 <-  mutate(q1_2019, ride_id = as.character(ride_id)
,rideable_type = as.character(rideable_type))
all_trips <- all_trips %>%
select(-c(start_lat, start_lng, end_lat, end_lng, birthyear, gender,  "tripduration"))
all_trips <- all_trips %>%
select(-c(start_lat, start_lng, end_lat, end_lng, birthyear, gender,  "tripduration"))
all_trips <- bind_rows(q1_2019, q1_2020)#, q3_2019)#, q4_2019, q1_2020)
all_trips <- all_trips %>%
select(-c(start_lat, start_lng, end_lat, end_lng, birthyear, gender,  "tripduration"))
all_trips <- all_trips %>%
select(-c(start_lat, start_lng, end_lat, end_lng, birthyear, gender,  "tripduration"))
all_trips <- mutate(all_trips, member_casual = ifelse(member_casual == "Subscriber", "member", member_casual))
all_trips <- mutate(all_trips, member_casual = ifelse(member_casual == "Customer", "casual", member_casual))
all_trips$date <- as.Date(all_trips$started_at)
all_trips$month <- format(as.Date(all_trips$date), "%m")
all_trips$day <- format(as.Date(all_trips$date), "%d")
all_trips$year <- format(as.Date(all_trips$date), "%Y")
all_trips$day_of_week <- format(as.Date(all_trips$date), "%A")
all_trips$ride_length <- difftime(all_trips$ended_at,all_trips$started_at)
all_trips$ride_length <- as.numeric(as.character(all_trips$ride_length))
all_trips_v2 <- all_trips[!(all_trips$start_station_name == "HQ QR" | all_trips$ride_length<0),]
View(all_trips)
View(all_trips)
View(all_trips_v2)
View(all_trips_v2)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual + all_trips_v2$day_of_week, FUN = mean)
all_trips_v2 %>% mutate(weekday = wday(started_at, label = TRUE)) %>%  group_by(member_casual, weekday) %>%  summarise(number_of_rides = n(),average_duration = mean(ride_length)) %>% arrange(member_casual, weekday)
aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual + all_trips_v2$day_of_week, FUN = mean)
install.packages("ggplot2")
install.packages("ggplot2")
library(ggplot2)
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge")
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Number of Riders per Rider Type", x = "Day of the Week", y = "Total Number of Rides", fill = "Rider Type")
ggsave('visualization_riders per rider type.png', width = 8, height = 5)
vis_riders_per_type <- all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Number of Riders per Rider Type", x = "Day of the Week", y = "Total Number of Rides", fill = "Rider Type")
# Let's create a visualization for average duration
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge")
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration", fill = "Rider Type")
vis_avg_ride_duration_per_weekday <- all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration", fill = "Rider Type")
ggsave("visualization_average rider duration per week day.png", width=8, height=5)
counts <- aggregate(all_trips_v2$ride_length ~ all_trips_v2$member_casual + all_trips_v2$day_of_week, FUN = mean)
write.csv(counts, file = 'avg_ride_length.csv')
vis_avg_ride_duration_per_weekday <- all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration", fill = "Rider Type") + scale_y_continuous(comma)
install.packages(scales)
install.packages("scales")
install.packages("scales")
library(scales)
vis_avg_ride_duration_per_weekday <- all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration", fill = "Rider Type") + scale_y_continuous(comma)
view(vis_avg_ride_duration_per_weekday)
vis_avg_ride_duration_per_weekday <- all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration", fill = "Rider Type")
vis_riders_per_type <- all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Number of Rides per Week Day", x = "Day of the Week", y = "Total Number of Rides", fill = "Rider Type") + scale_y_continuous(comma)
view(vis_riders_per_type)
View(vis_riders_per_type)
View(vis_riders_per_type)
View(vis_riders_per_type)
vis_riders_per_type
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Number of Rides per Week Day", x = "Day of the Week", y = "Total Number of Rides", fill = "Rider Type") + scale_y_continuous(comma)
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration", fill = "Rider Type")
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Rides per Weekday", x = "Day of the Week", y = "Total Number of Rides", fill = "Rider Type") + scale_y_continuous(comma)
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Rides per Weekday", x = "Day of the Week", y = "Total Number of Rides", fill = "Rider Type") + scale_y_continuous(labels = comma)
ggsave("rides per weekday.png", width=8, height=5)
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration", fill = "Rider Type")
390/60
441/60
1727/60
2333/60
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration", fill = "Rider Type")+
scale_y_continuous(labels = function(x) paste0(x, "sec"))
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration", fill = "Rider Type")+
scale_y_continuous(labels = function(x) paste0(x, " s"))
clear
all_trips_v3 <- all_trips_v2
all_trips_v3$ride_length_min <- all_trips_v3$ride_length /60
view(all_trips_v3)
q
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration", fill = "Rider Type")+
scale_y_continuous(labels = function(x) paste0(x, " s"))
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day (min)", x = "Day of the Week", y = "Average Ride Duration", fill = "Rider Type")
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type")
ggsave("avg ride duration per week day in min.png", width = 8, height = 5)
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean((ride_length_min/3600)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (hours)", fill = "Rider Type")
q
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean((ride_length_min/3600)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (hours)", fill = "Rider Type")
q
ride_length_hrs <- all_trips_v2$ride_length / 3600
ride_length_hrs
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length_hrs) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (hours)", fill = "Rider Type")
q
all_trips_v3$ride_length_hours <- all_trips_v3$ride_length / 3600
view(all_trips_v3)
q
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length_hrs)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (hrs)", fill = "Rider Type")
library(tidyverse)
library(dplyr)
library(confliceted)
library(conflicted)
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type")
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type") + scale_fill_manual
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type") + scale_fill_manual(values = c("casual" = "red", "member" = "blue"))
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type") + scale_fill_manual(values = c("casual" = "gainsboro", "member" = "aliceblue"))
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type") + scale_fill_manual(values = c("casual" = "darkslateblue", "member" = "dodgerblue"))
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type") + scale_fill_manual(values = c("casual" = "darkslateblue", "member" = "mediumorchid"))
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type") + scale_fill_manual(values = c("casual" = "seagreen", "member" = "mediumorchid"))
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type") + scale_fill_manual(values = c("casual" = "darkslateblue", "member" = "paletturquoise"))
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type") + scale_fill_manual(values = c("casual" = "darkslateblue", "member" = "paleturquoise"))
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type") + scale_fill_manual(values = c("casual" = "aqua", "member" = "palegreen"))
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type") + scale_fill_manual(values = c("casual" = "lightseagreen", "member" = "lemonchiffon"))
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type") + scale_fill_manual(values = c("casual" = "lightseagreen", "member" = "lemonchiffon")) + theme(plot.background = element_rect(fill = "darkgray", color = NA))
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type") + scale_fill_manual(values = c("casual" = "lightseagreen", "member" = "lemonchiffon")) + theme(panel.background = element_rect(fill = "darkgray", color = NA))
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type") + scale_fill_manual(values = c("casual" = "lightseagreen", "member" = "lemonchiffon")) + theme(panel.background = element_rect(fill = "gray", color = NA))
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Rides per Weekday", x = "Day of the Week", y = "Total Number of Rides", fill = "Rider Type") + scale_y_continuous(labels = comma) +
scale_fill_manual(values = c("casual" = "lightseagreen", "member" = "lemonchiffon"))+
theme(panel.background = element_rect(fill = "gray", color = NA))
library(scales)
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = number_of_rides, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Rides per Weekday", x = "Day of the Week", y = "Total Number of Rides", fill = "Rider Type") + scale_y_continuous(labels = comma) +
scale_fill_manual(values = c("casual" = "lightseagreen", "member" = "lemonchiffon"))+
theme(panel.background = element_rect(fill = "gray", color = NA))
ggsave("rides per weekday.png", width = 8, height = 5)
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (seconds)", fill = "Rider Type") +
scale_fill_manual(values = c("casual" = "lightseagreen", "member" = "lemonchiffon"))+
+      theme(panel.background = element_rect(fill = "gray", color = NA))
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (seconds)", fill = "Rider Type") +
scale_fill_manual(values = c("casual" = "lightseagreen", "member" = "lemonchiffon"))+
theme(panel.background = element_rect(fill = "gray", color = NA))
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Weekday", x = "Day of the Week", y = "Average Ride Duration (seconds)", fill = "Rider Type") +
scale_fill_manual(values = c("casual" = "lightseagreen", "member" = "lemonchiffon"))+
theme(panel.background = element_rect(fill = "gray", color = NA))
ggsave("avg ride duration per weekday.png")
all_trips_v3 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n(),average_duration = mean(ride_length_min)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (min)", fill = "Rider Type") +
scale_fill_manual(values = c("casual" = "lightseagreen", "member" = "lemonchiffon"))+
theme(panel.background = element_rect(fill = "gray", color = NA))
ggsave("avg ride duration per weekday min.png", width=8, height = 5)
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (seconds)", fill = "Rider Type") +
scale_fill_manual(values = c("casual" = "lightseagreen", "member" = "lemonchiffon"))+
+      theme(panel.background = element_rect(fill = "gray", color = NA))
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (seconds)", fill = "Rider Type") +
scale_fill_manual(values = c("casual" = "lightseagreen", "member" = "lemonchiffon"))
+      theme(panel.background = element_rect(fill = "gray", color = NA))
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (seconds)", fill = "Rider Type") +
scale_fill_manual(values = c("casual" = "lightseagreen", "member" = "lemonchiffon"))
+      theme(panel.background = element_rect(fill = "gray", color = NA))
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (seconds)", fill = "Rider Type") +
scale_fill_manual(values = c("casual" = "lightseagreen", "member" = "lemonchiffon"))+
theme(panel.background = element_rect(fill = "gray", color = NA))
all_trips_v2 %>%
mutate(weekday = wday(started_at, label = TRUE)) %>%
group_by(member_casual, weekday) %>%
summarise(number_of_rides = n()
,average_duration = mean(ride_length)) %>%
arrange(member_casual, weekday)  %>%
ggplot(aes(x = weekday, y = average_duration, fill = member_casual)) +
geom_col(position = "dodge") + labs(title = "Average Ride Duration Per Week Day", x = "Day of the Week", y = "Average Ride Duration (seconds)", fill = "Rider Type") +
scale_fill_manual(values = c("casual" = "lightseagreen", "member" = "lemonchiffon"))+
theme(panel.background = element_rect(fill = "gray", color = NA))
ggsave("avg ride duration per weekday.png", height = 8, width = 5)
knitr::opts_chunk$set(echo = TRUE)
install.packages(conflicted)
install.packages("conflicted")
install.packages("conflicted")
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
nrows(all_trips)
install.packages("tinytex")
tinytex::install_tinytex()
install.packages("tinytex")
tinytex::is_tinytex()
installed.packages("tinytex")
installed.package("tinytex")
install.packages("tinytex")
install.packages("tinytex")
